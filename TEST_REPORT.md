# –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ Alification3

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. –ö–æ–º–ø–∏–ª—è—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ **–°—Ç–∞—Ç—É—Å**: –£—Å–ø–µ—à–Ω–æ
- ‚úÖ **–û—à–∏–±–æ–∫**: 0
- ‚úÖ **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π**: 0
- ‚úÖ **–í—Ä–µ–º—è —Å–±–æ—Ä–∫–∏**: ~1.5 —Å–µ–∫—É–Ω–¥—ã

### 2. –õ–∏–Ω—Ç–µ—Ä
- ‚úÖ **–°—Ç–∞—Ç—É—Å**: –û—à–∏–±–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
- ‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –ª–∏–Ω—Ç–µ—Ä–∞

### 3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

#### –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (4 —Ñ–∞–π–ª–∞)
- ‚úÖ `AdminController.cs` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `IAdminService`
- ‚úÖ `FirstController.cs` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏
- ‚úÖ `HomepageController.cs` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `IHomepageService`
- ‚úÖ `RoomController.cs` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `IRoomService`, –≤–∫–ª—é—á–∞–µ—Ç –Ω–æ–≤—ã–π endpoint `/api/rooms/findroom`

#### –°–µ—Ä–≤–∏—Å—ã (8 —Ñ–∞–π–ª–æ–≤)
- ‚úÖ `AdminService.cs` - —Ä–µ–∞–ª–∏–∑—É–µ—Ç `IAdminService`
- ‚úÖ `HomepageService.cs` - —Ä–µ–∞–ª–∏–∑—É–µ—Ç `IHomepageService`
- ‚úÖ `RoomService.cs` - —Ä–µ–∞–ª–∏–∑—É–µ—Ç `IRoomService`, –≤–∫–ª—é—á–∞–µ—Ç Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è `GetAvailableTimeslots`
- ‚úÖ `TelegramAuthService.cs` - –≤–∞–ª–∏–¥–∞—Ü–∏—è Telegram –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ `TelegramNotificationService.cs` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Telegram
- ‚úÖ `BookingNotificationBackgroundService.cs` - —Ñ–æ–Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

#### –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (3 —Ñ–∞–π–ª–∞)
- ‚úÖ `IAdminService.cs`
- ‚úÖ `IHomepageService.cs`
- ‚úÖ `IRoomService.cs`

#### –ò—Å–∫–ª—é—á–µ–Ω–∏—è (2 —Ñ–∞–π–ª–∞)
- ‚úÖ `ConflictException.cs`
- ‚úÖ `ForbiddenException.cs`

### 4. Dependency Injection
- ‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ `Program.cs`:
  - `IRoomService` ‚Üí `RoomService` (Scoped)
  - `IHomepageService` ‚Üí `HomepageService` (Scoped)
  - `IAdminService` ‚Üí `AdminService` (Scoped)
  - `ITelegramNotificationService` ‚Üí `TelegramNotificationService` (Scoped)
  - `BookingNotificationBackgroundService` (HostedService)
  - `TelegramAuthService` (Scoped)
  - `HttpClient` (–¥–ª—è Telegram API)

### 5. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### –ú–∏–≥—Ä–∞—Ü–∏–∏
- ‚úÖ `20251104073310_InitialCreate` - –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
- ‚ö†Ô∏è `20251107164117_AddNotificationSent` - **Pending (—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ)**

#### –ö–æ–Ω—Ç–µ–∫—Å—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ `MyContext.cs` –≤–∫–ª—é—á–∞–µ—Ç:
  - `Users` (—Å `TelegramId`)
  - `Companies`
  - `Rooms`
  - `Bookings`
  - `NotificationsSent` (–Ω–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞)

### 6. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

#### appsettings.json
- ‚úÖ `ConnectionStrings:Default` - –Ω–∞—Å—Ç—Ä–æ–µ–Ω (PostgreSQL)
- ‚úÖ `ConnectionStrings:Redis` - –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ `Telegram:BotToken` - –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ `Jwt` - –Ω–∞—Å—Ç—Ä–æ–µ–Ω (Issuer, Audience, Key, ExpiryMinutes)

### 7. –ü–∞–∫–µ—Ç—ã NuGet
- ‚úÖ `BCrypt.Net-Next` (4.0.3)
- ‚úÖ `Microsoft.AspNetCore.Authentication.JwtBearer` (9.0.7)
- ‚úÖ `Microsoft.EntityFrameworkCore` (9.0.10)
- ‚úÖ `Microsoft.EntityFrameworkCore.Design` (9.0.10)
- ‚úÖ `Microsoft.Extensions.Caching.StackExchangeRedis` (9.0.1)
- ‚úÖ `Npgsql.EntityFrameworkCore.PostgreSQL` (9.0.4)
- ‚úÖ `Swashbuckle.AspNetCore` (9.0.6)
- ‚úÖ `Telegram.Bot` (22.7.4)

### 8. –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –¥–ª—è `GetAvailableTimeslots`
- ‚úÖ –ö—ç—à –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ—Ç–º–µ–Ω–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ TTL: 5 –º–∏–Ω—É—Ç

#### –§–∏–ª—å—Ç—Ä –∫–æ–º–Ω–∞—Ç (`/api/rooms/findroom`)
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (StartAt, EndAt)
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ (MinCapacity, MaxCapacity)
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é (Name)
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é (Description)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫–æ–º–Ω–∞—Ç—ã

#### –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ –§–æ–Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
- ‚úÖ –ù–∞—Ö–æ–¥–∏—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç (¬±1 –º–∏–Ω—É—Ç–∞)
- ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å –≤–∞–ª–∏–¥–Ω—ã–º `TelegramId`
- ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Telegram Bot API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

## ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏–µ

### –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
dotnet ef database update --project Api
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—É `NotificationsSent` –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

## üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏:

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**
   ```bash
   dotnet run --project Api
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É —Ñ–æ–Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞**
   - –õ–æ–≥–∏ –¥–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å: "BookingNotificationBackgroundService started"
   - –°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É

3. **–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - –°–æ–∑–¥–∞—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å –≤–∞–ª–∏–¥–Ω—ã–π `TelegramId`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ Telegram

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - –í—ã–∑–≤–∞—Ç—å `GET /api/rooms/{roomId}/timeslots?date=...`
   - –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—ã–∑–æ–≤ –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à (–±—ã—Å—Ç—Ä–µ–µ)

5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –∫–æ–º–Ω–∞—Ç**
   - –í—ã–∑–≤–∞—Ç—å `GET /api/rooms/findroom?MinCapacity=5&Name=Conference`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## ‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

**–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞**: ‚úÖ **–ì–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É**

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã, —Å–µ—Ä–≤–∏—Å—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã. –¢—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –∑–∞–ø—É—Å–∫–æ–º.

